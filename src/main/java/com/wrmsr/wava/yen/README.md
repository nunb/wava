Seriously, it's gross in here. This is a mechanical C++ translation. You have been warned.
